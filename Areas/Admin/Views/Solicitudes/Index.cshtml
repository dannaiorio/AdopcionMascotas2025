@model IEnumerable<AdopcionMascotas.Models.SolicitudAdopcion>

<h2 class="text-primary mb-3">📋 Solicitudes de Adopción</h2>

<table class="table table-striped text-center align-middle">
    <thead class="table-dark">
        <tr>
            <th>Mascota</th>
            <th>Adoptante</th>
            <th>Email</th>
            <th>Teléfono</th>
            <th>Ciudad</th>
            <th>Tipo Vivienda</th>
            <th>Espacio Exterior</th>
            <th>Otras Mascotas</th>
            <th>Motivo</th>
            <th>Fecha</th>
            <th>Estado</th>
            <th>Acción</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var s in Model)
        {
            <tr>
                <td>@s.Mascota?.Nombre</td>
                <td>@s.NombreApellido</td>
                <td>@s.Email</td>
                <td>@s.Telefono</td>
                <td>@s.Ciudad</td>
                <td>@s.TipoVivienda</td>
                <td>@s.EspacioExterior</td>
                <td>@s.OtrasMascotas</td>
                <td>@s.Motivo</td>
                <td>@s.FechaSolicitud.ToShortDateString()</td>

                <!-- Nueva columna Estado -->
                <td>
                    <span class="badge @(s.Estado == AdopcionMascotas.Models.EstadoSolicitud.Pendiente ? "bg-warning text-dark" : 
                                        s.Estado == AdopcionMascotas.Models.EstadoSolicitud.Aceptada ? "bg-success" :
                                        s.Estado == AdopcionMascotas.Models.EstadoSolicitud.Rechazada ? "bg-danger" : "bg-info")">
                        @s.Estado
                    </span>
                </td>

                <!-- Nueva columna Acción -->
                <td>
                    @if (s.Estado == AdopcionMascotas.Models.EstadoSolicitud.Pendiente)
                    {
                        <div class="btn-group" role="group">
                            <form asp-action="AceptarSolicitud" method="post" class="d-inline" 
                                  onsubmit="return confirm('¿Estás seguro de que quieres ACEPTAR esta solicitud? La mascota será marcada como adoptada.');">
                                <input type="hidden" name="id" value="@s.Id" />
                                <button type="submit" class="btn btn-sm btn-success me-1">
                                    <i class="fas fa-check"></i> Aceptar
                                </button>
                            </form>
                            
                            <form asp-action="RechazarSolicitud" method="post" class="d-inline"
                                  onsubmit="return confirm('¿Estás seguro de que quieres RECHAZAR esta solicitud?');">
                                <input type="hidden" name="id" value="@s.Id" />
                                <button type="submit" class="btn btn-sm btn-danger">
                                    <i class="fas fa-times"></i> Rechazar
                                </button>
                            </form>
                        </div>
                    }
                    else
                    {
                        <span class="text-muted">
                            <i class="fas fa-check-circle"></i> Procesada
                        </span>
                    }
                </td>
            </tr>
        }
    </tbody>
</table>
